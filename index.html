<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Naren Medarametla">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lilita+One:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Rubik+Doodle+Shadow&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Habibi&family=Rubik+Doodle+Shadow&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <title>Kavagyan</title>
    <script src="script.js"></script>
    <script src="auth.js"></script>
    <style>
        .language-dropdown {
            position: absolute;
            top: 75px;
            left: 40px;
            background-color: white;
            border: 2px solid black;
            border-radius: 10px;
            padding: 15px;
            display: none;
            z-index: 1000;
            width: 180px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .language-option {
            padding: 8px 10px;
            cursor: pointer;
            border-radius: 6px;
            margin-bottom: 5px;
            transition: all 0.3s;
            font-family: 'Habibi', serif;
        }
        
        .language-option:hover {
            background-color: #f0f0f0;
        }
        
        .language-icon {
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .language-icon:hover {
            transform: scale(1.1);
        }
        
        .timetable-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .timetable-dialog {
            width: 500px;
            background-color: #fff3e8;
            border: 3px solid black;
            border-radius: 15px;
            box-shadow: 4px 4px 15px rgba(0,0,0,0.3);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            max-height: 90vh;
        }
        
        .timetable-header {
            padding: 15px 20px;
            border-bottom: 2px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: rgb(144, 144, 205);
        }
        
        .timetable-title {
            font-family: 'Rubik Doodle Shadow', cursive;
            font-size: 24px;
            color: black;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: black;
        }
        
        .timetable-body {
            padding: 20px;
            height: 300px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        .message {
            margin-bottom: 15px;
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 15px;
            font-family: 'Habibi', serif;
        }
        
        .user-message {
            align-self: flex-end;
            background-color: lightcoral;
            color: white;
        }
        
        .bot-message {
            align-self: flex-start;
            background-color: #f0f0f0;
            color: black;
        }
        
        .timetable-footer {
            padding: 15px;
            border-top: 2px solid #ddd;
            display: flex;
        }
        
        .message-input {
            flex-grow: 1;
            padding: 10px;
            border: 2px solid #000;
            border-radius: 10px;
            font-family: 'Poppins', sans-serif;
            margin-right: 10px;
            outline: none;
        }
        
        .send-btn {
            background-color: lightcoral;
            color: white;
            border: 2px solid #000;
            border-radius: 10px;
            padding: 0 15px;
            font-family: 'Habibi', serif;
            cursor: pointer;
        }
        
        .timetable-result {
            margin-top: 15px;
            padding: 15px;
            background-color: #f9f9f9;
            border: 2px solid black;
            border-radius: 10px;
            font-family: 'Habibi', serif;
        }
    </style>
</head>

<body style="background-color: #D1D5C9;">
    <header>
        
        <div class="header-section header-left">
            <img src="assets/Language.png" alt="Language" width="50em" style="position: absolute; top: 20px; left: 40px;" class="language-icon" onclick="toggleLanguageDropdown()">
            <div id="language-dropdown" class="language-dropdown">
                <div class="language-option" onclick="changeLanguage('en')">English</div>
                <div class="language-option" onclick="changeLanguage('ta')">Tamil (தமிழ்)</div>
                <div class="language-option" onclick="changeLanguage('te')">Telugu (తెలుగు)</div>
                <div class="language-option" onclick="changeLanguage('ml')">Malayalam (മലയാളം)</div>
                <div class="language-option" onclick="changeLanguage('kn')">Kannada (ಕನ್ನಡ)</div>
            </div>
            <a href="https://www.youtube.com/@wxua5859"><img src="assets/Youtube.png" alt="youtube" width="50em" style="position: absolute; left: 140px; top: 24px;"></a>
        </div>

        <div class="header-middle">
            <h1 class="lilita-one-regular">Kavagyan</h1>
            <img src="assets/tree.png" alt="Tree" width="80em" style="position: absolute; right: 500px; top: 10px;">
        </div>

        <section>
            <img src="assets/maths.png" alt="Maths" class="maths-symbol">
        </section>

        <div class="header-section header-right lilita-one-regular">
            <a href="login.html" style="text-decoration: none; color: inherit;">
                <div class="button-class" style="width: 110px; height: 40px; background-color: rgb(144, 144, 205); font-family: Lilita-One; font-size: 24px;">Login</div>
            </a>
        </div>

    </header>

    <nav class="sidebar">
        <div class="nav-items">
            <a href="maths.html" style="color: inherit; text-decoration: none;"><span class="sidebar-text">Maths</span></a>
            <div class="horizontal-line"></div>
            <a href="physics.html" style="color: inherit; text-decoration: none;"><span class="sidebar-text">Physics</span></a>
            <div class="horizontal-line"></div>
            <a href="biology.html" style="color: inherit; text-decoration: none;"><span class="sidebar-text">Biology</span></a>
            <div class="horizontal-line"></div>
            <a href="english.html" style="color: inherit; text-decoration: none;"><span class="sidebar-text">English</span></a>
            <div class="horizontal-line"></div>
            <a href="aboutus.html" style="color: inherit; text-decoration: none;"><span class="sidebar-text">About Us</span></a>
            <div class="horizontal-line"></div>
            <a href="donate.html" style="color: inherit; text-decoration: none;"><span class="sidebar-text">Donate</span></a>
        </div>
    </nav>
        <div class="image-container">

            <img src="assets/children.webp" alt="Children;">
            <img src="assets/flag.png" alt="flag" style="position: absolute; left: 48em; top: 8em;">
            <button id="timetable-planner-btn" style="position: absolute; left: 50em; top: 3em; background-color: #b9c3db; border: 3px solid black; border-radius: 12px; padding: 10px; font-family: 'Lilita One'; font-size: 16px; cursor: pointer; transition: transform 0.3s ease; width: 200px;">Time Table Planner</button>

            <span class="image-text lilita-one-regular" style="text-align: left; font-size: 80px;">Our Aim</span>

            <div class="paragraph">
                <span style="display: block; font-family: Lilita One; font-size: 26px; line-height: 40px;" class="lilita-one-regular">We believe education is a fundamental right and a path to a better future. Our mission is to provide learning opportunities to children, equipping them with the knowledge and skills they need to grow and succeed. By nurturing young minds, we hope to inspire future leaders and contributors who will help build a stronger and more progressive society.</span>
            </div>
        </div>
        <div style="width: 1300px; height: 300px; margin-top: 50em; margin-bottom: 50px; margin-left: auto; display:flex; align-items: center; justify-content: center; gap: 60px;">
            <div class="achievements">
                <img src="assets/graduation-hat.png" alt="hat" style="height: 70px;">
                <span class="achievement-text">50,000+</span>
                <span class="achievement-text">Students Educated</span>
            </div>
            <div class="achievements">
                <img src="assets/trophy.png" alt="trophy" style="height: 65px;">
                <span class="achievement-text">1000000+</span>
                <span class="achievement-text">Total Views</span>
            </div>
            <div class="achievements">
                <img src="assets/guru.png" alt="guru" style="height: 65px;">
                <span class="achievement-text">200+</span>
                <span class="achievement-text">Videos Uploaded</span>
            </div>
        </div>

        <div style="display: block; font-size: 80px; font-family: Lilita One; margin-left: 120px; margin-bottom: 100px; display: flex; flex-direction: column; gap: 40px;">
            Our Journey
            <div style="display: flex">
                <div style="font-size: 26px; line-height: 45px; flex-wrap: wrap; width: 700px; background-color: #bdc1ac; padding-left: 20px; border-radius: 25px; padding-bottom: 10px; padding-right: 10px;">
                    It all started with just three passionate educators sitting in a small café, fueled by a shared dream—to make learning accessible and engaging for students everywhere. With just a laptop and an idea, we built the first version of our platform, focusing on a few core subjects for middle school students.
                </div>
                 <img src="assets/sidebar-photo-1.jpg" alt="sidebar-photo" width="600" height="250" style="padding-left: 30px; padding-top: 5px; border-radius: 20px 200px / 220px;">
            </div>
            <div style="display: flex">
                <div style="font-size: 26px; line-height: 45px; flex-wrap: wrap; width: 700px; background-color: #bdc1ac; padding-left: 20px; border-radius: 25px; padding-bottom: 10px; padding-right: 10px;">
                As word spread, more students joined, and so did our team. Within a year, we grew to a team of 10, adding skilled teachers, designers, and developers who believed in our mission. What started as a small initiative quickly transformed into a full-fledged educational platform.
                </div>
                <img src="assets/sidebar-photo-3.jpg" alt="sidebar-photo" width="600" height="250" style="padding-left: 30px; border-radius: 20px 200px / 220px;">
            </div>
            <div style="display: flex">
                <div style="font-size: 26px; line-height: 45px; flex-wrap: wrap; width: 700px; background-color: #bdc1ac; padding-left: 20px; border-radius: 25px; padding-bottom: 10px; padding-right: 10px;">
                    Today, we are a team of 25+ educators, developers, and innovators, working together to bring high-quality learning resources to students across multiple grade levels. From interactive lessons to personalized learning paths, we continue to expand, ensuring that education is not just a requirement but an exciting journey for every student.
                </div>
                <img src="assets/sidebar-photo-2.jpg" alt="sidebar-photo" width="600" height="250" style="padding-left: 30px; border-radius: 20px 200px / 220px;"> 
            </div>
        </div>
        <div style="width: auto; height: 200px; background-color: #f7e8c5; display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 20px;">
            <div style="display: flex; flex-direction: row; justify-content: center; align-items: center; gap: 440px;">
               <a href="https://www.linkedin.com/in/naren-medarametla-81a36628b/"><img src="assets/linkedin.png" alt="linkedin" width="70" height="70"></a>
                <img src="assets/instagram.png" alt="instagram" width="120" height="120">
                <img src="assets/facebook.png" alt="facebook" width="70" height="70">
            </div>
            <div style="display: flex; flex-direction: row; gap: 180px; font-family: 'Lilita One'; font-size: 20px; background-color: #EDEDE9; padding-left: 128px; padding-right: 180px; padding-bottom: 20px; justify-content: center; padding-top: 20px;">
                <a href="terms-of-service.html" style="text-decoration: none; color: black;">Terms of Service</a>
                <a href="privacy-policy.html" style="text-decoration: none; color: black;">Privacy Policy</a>
                <a href="#" style="text-decoration: none; color: black;">Contact Us</a>
                <a href="#" style="text-decoration: none; color: black;">Help</a>
                <a href="#" onclick="showFeedbackForm(); return false;" style="text-decoration: none; color: black;">Feedback</a>
            </div>
        </div>

        <div id="timetable-modal" class="timetable-modal">
            <div class="timetable-dialog">
                <div class="timetable-header">
                    <span class="timetable-title">Time Table Planner</span>
                    <button class="close-btn" onclick="closeTimetableModal()">×</button>
                </div>
                <div class="timetable-body" id="chat-messages">
                    <div class="message bot-message">
                        Hello! I'm your Time Table Planner assistant. Tell me about your schedule, classes, and activities, and I'll help you organize a structured timetable.
                    </div>
                </div>
                <div class="timetable-footer">
                    <input type="text" id="message-input" class="message-input" placeholder="Type your message...">
                    <button class="send-btn" onclick="sendMessage()">Send</button>
                </div>
            </div>
        </div>
</body>
<script>
    function toggleLanguageDropdown() {
        const dropdown = document.getElementById('language-dropdown');
        if (dropdown.style.display === 'block') {
            dropdown.style.display = 'none';
        } else {
            dropdown.style.display = 'block';
        }
    }
    
    function changeLanguage(languageCode) {
        localStorage.setItem('preferredLanguage', languageCode);
        
                document.getElementById('language-dropdown').style.display = 'none';
    }
    
    function getLanguageName(code) {
        const languages = {
            'en': 'English',
            'ta': 'Tamil (தமிழ்)',
            'te': 'Telugu (తెలుగు)',
            'ml': 'Malayalam (മലയാളം)',
            'kn': 'Kannada (ಕನ್ನಡ)'
        };
        return languages[code] || 'Unknown';
    }
    
    document.addEventListener('DOMContentLoaded', function() {
        const preferredLanguage = localStorage.getItem('preferredLanguage');
    });

    const timetableModal = document.getElementById('timetable-modal');
    const timetablePlannerBtn = document.getElementById('timetable-planner-btn');
    const messageInput = document.getElementById('message-input');
    const chatMessages = document.getElementById('chat-messages');

    const TIMETABLE_API_URL = 'http://localhost:5005/api/timetable';
    
    timetablePlannerBtn.addEventListener('click', function() {
        timetableModal.style.display = 'flex';
    });

    function closeTimetableModal() {
        timetableModal.style.display = 'none';
    }

    function addMessageToChat(message, isUser = false) {
        const messageElement = document.createElement('div');
        messageElement.className = isUser ? 'message user-message' : 'message bot-message';
        messageElement.textContent = message;
        chatMessages.appendChild(messageElement);
        
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function displayTimetable(response) {
        const timetableElement = document.createElement('div');
        timetableElement.className = 'timetable-result';
        
        if (!response || typeof response !== 'object') {
            timetableElement.innerHTML = '<p>Sorry, I received an invalid response. Please try again.</p>';
            chatMessages.appendChild(timetableElement);
            return;
        }
        
        let timetableHTML = `<h3>${response.message || 'Here\'s your timetable:'}</h3>`;
        
        if (response.timetable && typeof response.timetable === 'object') {
            timetableHTML += '<div style="margin-top:10px;">';
            try {
                Object.entries(response.timetable).forEach(([time, activity]) => {
                    timetableHTML += `<p><strong>${time}</strong>: ${activity}</p>`;
                });
            } catch (err) {
                console.error('Error processing timetable:', err);
                timetableHTML += '<p>Error displaying timetable details</p>';
            }
            timetableHTML += '</div>';
        } else {
            timetableHTML += '<p>No timetable details available</p>';
        }
        
        if (response.suggestions && Array.isArray(response.suggestions) && response.suggestions.length > 0) {
            timetableHTML += '<h4>Suggestions:</h4><ul>';
            response.suggestions.forEach(suggestion => {
                timetableHTML += `<li>${suggestion}</li>`;
            });
            timetableHTML += '</ul>';
        }
        
        if (response.explanation) {
            timetableHTML += `<p><em>${response.explanation}</em></p>`;
        }
        
        timetableElement.innerHTML = timetableHTML;
        chatMessages.appendChild(timetableElement);
        
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function sendMessage() {
        const messageText = messageInput.value.trim();
        if (messageText) {
            addMessageToChat(messageText, true);
            messageInput.value = '';
            
            const loadingMessage = document.createElement('div');
            loadingMessage.className = 'message bot-message';
            loadingMessage.id = 'loading-message';
            loadingMessage.textContent = 'Planning your timetable...';
            chatMessages.appendChild(loadingMessage);
            
            fetch(TIMETABLE_API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ message: messageText })
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                const loadingMsg = document.getElementById('loading-message');
                if (loadingMsg) loadingMsg.remove();
                
                displayTimetable(data);
            })
            .catch(error => {
                const loadingMsg = document.getElementById('loading-message');
                if (loadingMsg) loadingMsg.remove();
                
                addMessageToChat('Sorry, there was an error processing your request. Please try again later.', false);
                console.error('Error:', error);
            });
        }
    }

    messageInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            sendMessage();
        }
    });

    window.onclick = function(event) {
        if (event.target == timetableModal) {
            closeTimetableModal();
        }
    };
</script>
 
</html>